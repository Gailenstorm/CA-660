#!/usr/bin/bash
BIN_DIR="$(dirname "$0")"
DATA_DIR=data
RAW_DATA_DIR="$DATA_DIR/raw"
PROCESSED_DATA_DIR="$DATA_DIR/processed"
rm -rf "$PROCESSED_DATA_DIR/"*

RAW_RESIDENTIAL_FILE="$RAW_DATA_DIR/property.csv"
RAW_EIRCODE_FILE="$RAW_DATA_DIR/eircodes.csv"
RAW_POPULATION_FILE="$RAW_DATA_DIR/population.csv"
RAW_POP_2006_FILE="$RAW_DATA_DIR/2006_population.csv"
RAW_HISTORICAL_POP_FILE="$RAW_DATA_DIR/historical_population.csv" RAW_RENT_FILE="$RAW_DATA_DIR/rent.csv"
RAW_INCOME_FILE="$RAW_DATA_DIR/income.csv"
RAW_UNEMPLOYMENT_FILE="$RAW_DATA_DIR/unemployment.csv"
RAW_CONSTRUCTION_EMPLOY_FILE="$RAW_DATA_DIR/construction_employment.csv"
RAW_CONSTRUCTION_COST_FILE="$RAW_DATA_DIR/construction_cost.csv"
RAW_PLANNING_FILE="$RAW_DATA_DIR/planning.csv"
RAW_MIGRATION_FILE="$RAW_DATA_DIR/migration.csv"
RAW_POP_PROJECTION_FILE="$RAW_DATA_DIR/population_projection.csv"
RAW_REGIONS_FILE="$RAW_DATA_DIR/region.csv"

PROCESSED_RESIDENTIAL_FILE="$PROCESSED_DATA_DIR/property.csv"
PROCESSED_POPULATION_FILE="$PROCESSED_DATA_DIR/population.csv"
PROCESSED_RENT_FILE="$PROCESSED_DATA_DIR/rent.csv"
PROCESSED_INCOME_FILE="$PROCESSED_DATA_DIR/income.csv"
PROCESSED_UNEMPLOYMENT_FILE="$PROCESSED_DATA_DIR/unemployment.csv"
PROCESSED_CONSTRUCTION_EMPLOY_FILE="$PROCESSED_DATA_DIR/construction_employment.csv"
PROCESSED_CONSTRUCTION_COST_FILE="$PROCESSED_DATA_DIR/construction_cost.csv"
PROCESSED_PLANNING_FILE="$PROCESSED_DATA_DIR/planning.csv"
PROCESSED_MIGRATION_FILE="$PROCESSED_DATA_DIR/migration.csv"
PROCESSED_POP_PROJECTION_FILE="$PROCESSED_DATA_DIR/population_projection.csv"
PROCESSED_REGIONS_FILE="$PROCESSED_DATA_DIR/region.csv"

INTERPOLATED_POPULATION_FILE="$PROCESSED_DATA_DIR/interpolated_population.csv"
INTERPOLATED_POP_PROJECTION_FILE="$PROCESSED_DATA_DIR/interpolated_population_projection.csv"

awk -f "$BIN_DIR/process-property-file.awk" "$RAW_EIRCODE_FILE" "$RAW_RESIDENTIAL_FILE" > "$PROCESSED_RESIDENTIAL_FILE"
awk -f "$BIN_DIR/process-population-file.awk" "$RAW_POPULATION_FILE" "$RAW_POP_2006_FILE" "$RAW_HISTORICAL_POP_FILE" > "$PROCESSED_POPULATION_FILE"
awk -f "$BIN_DIR/process-rent-file.awk" "$RAW_RENT_FILE" > "$PROCESSED_RENT_FILE"
awk -f "$BIN_DIR/process-income-file.awk" "$RAW_INCOME_FILE" > "$PROCESSED_INCOME_FILE"
awk -f "$BIN_DIR/process-unemployment-file.awk" "$RAW_UNEMPLOYMENT_FILE" > "$PROCESSED_UNEMPLOYMENT_FILE"
awk -f "$BIN_DIR/process-construction-employment-file.awk" "$RAW_CONSTRUCTION_EMPLOY_FILE" > "$PROCESSED_CONSTRUCTION_EMPLOY_FILE"
awk -f "$BIN_DIR/process-construction-cost-file.awk" "$RAW_CONSTRUCTION_COST_FILE" > "$PROCESSED_CONSTRUCTION_COST_FILE"
awk -f "$BIN_DIR/process-planning-file.awk" "$RAW_PLANNING_FILE" > "$PROCESSED_PLANNING_FILE"
awk -f "$BIN_DIR/process-migration-file.awk" "$RAW_MIGRATION_FILE" > "$PROCESSED_MIGRATION_FILE"
awk -f "$BIN_DIR/process-population-projection-file.awk" "$RAW_POP_PROJECTION_FILE" > "$PROCESSED_POP_PROJECTION_FILE"

awk -f "$BIN_DIR/interpolate-population.awk" "$PROCESSED_POPULATION_FILE" > "$INTERPOLATED_POPULATION_FILE"

cp "$RAW_REGIONS_FILE" "$PROCESSED_REGIONS_FILE"
